"use strict";(self["webpackChunkbizlx"]=self["webpackChunkbizlx"]||[]).push([[5509],{6133:function(e,t,s){s.r(t),s.d(t,{default:function(){return R}});var i=s(344),a=s(4562),n=s(4145),o=s(4886),l=s(266),c=s(9256),r=s(3863),d=s(1030),u=s(4061),h=s(9223),m=s(5125),v=s(4324),f=s(4568),p=s(1713),g=s(9481),x=s(9258),w=s(3687),b=s(9780),k=s(2648),Z=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"row"},[e._m(0),t("div",{staticClass:"col-2"},[t("div",{staticClass:"my-2"},[t(a.Z,{attrs:{color:"error",dark:"",large:""},on:{click:e.exportData}},[e._v("Export Excel")])],1)]),t("div",{staticClass:"col-6"},[t(b.Z,{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),t(p.Z,[t(l.Z,{attrs:{cols:"4",sm:"4"}},[t(i.Z,{attrs:{items:e.cities,"item-text":"city","item-value":"id",label:"City",dense:""},on:{change:function(t){return e.getSelectedData()}},model:{value:e.city,callback:function(t){e.city=t},expression:"city"}})],1),t(l.Z,{attrs:{cols:"4",sm:"4"}},[t(i.Z,{attrs:{items:e.businesses,"item-text":"name","item-value":"id",label:"Business",dense:""},on:{change:function(t){return e.getSelectedData()}},model:{value:e.business,callback:function(t){e.business=t},expression:"business"}})],1),t(l.Z,{attrs:{cols:"4",sm:"4"}},[t(i.Z,{attrs:{items:e.users,"item-text":"name","item-value":"id",label:"User",dense:""},on:{change:function(t){return e.getSelectedData()}},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}})],1)],1),t(p.Z,[t(l.Z,{attrs:{cols:"4",sm:"4"}},[t(g.Z,{attrs:{items:e.reviewRating,"item-text":"value","item-value":"value",label:"Star Rating"},on:{change:function(t){return e.getSelectedData()}},model:{value:e.rating,callback:function(t){e.rating=t},expression:"rating"}})],1),t(l.Z,{attrs:{cols:"4",sm:"6",md:"4"}},[t(f.Z,{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:i}){return[t(b.Z,e._g(e._b({attrs:{label:"Date From","prepend-icon":"mdi-calendar"},model:{value:e.date1,callback:function(t){e.date1=t},expression:"date1"}},"v-text-field",i,!1),s))]}}]),model:{value:e.menu1,callback:function(t){e.menu1=t},expression:"menu1"}},[t(d.Z,{on:{input:function(t){e.menu1=!1},change:function(t){return e.getSelectedData()}},model:{value:e.date1,callback:function(t){e.date1=t},expression:"date1"}})],1)],1),t(l.Z,{attrs:{cols:"4",sm:"6",md:"4"}},[t(f.Z,{attrs:{"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:i}){return[t(b.Z,e._g(e._b({attrs:{label:"Date To","prepend-icon":"mdi-calendar"},model:{value:e.date2,callback:function(t){e.date2=t},expression:"date2"}},"v-text-field",i,!1),s))]}}]),model:{value:e.menu2,callback:function(t){e.menu2=t},expression:"menu2"}},[t(d.Z,{on:{input:function(t){e.menu2=!1},change:function(t){return e.getSelectedData()}},model:{value:e.date2,callback:function(t){e.date2=t},expression:"date2"}})],1)],1)],1),t("div",{},[t(r.Z,{ref:"myDataTable",staticClass:"elevation-1",attrs:{search:e.search,headers:e.headers,items:e.reviews,"sort-by":"calories","show-select":"","multi-select":""},scopedSlots:e._u([{key:"top",fn:function(){return[t(h.Z,{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),t(w.Z),t(u.Z,{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t(n.Z,[t(o.EB,{staticClass:"text-h5 grey lighten-2",staticStyle:{"justify-content":"space-between"}},[e._v(e._s(e.formTitle)+" "),t(v.Z,{staticClass:"text-h5",on:{click:e.close}},[e._v("mdi-close")])],1),t(o.ZB,[t(m.Z,{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(t){return t.preventDefault(),e.ReviewFormUpdate.apply(null,arguments)}},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(c.Z,[t(p.Z,[t(l.Z,{attrs:{cols:"12",sm:"6",md:"12"}},[t(k.Z,{attrs:{rules:e.review_textRules,counter:255,dense:""},model:{value:e.editedItem.review_text,callback:function(t){e.$set(e.editedItem,"review_text",t)},expression:"editedItem.review_text"}})],1),t(o.h7,[t(a.Z,{staticClass:"cred",on:{click:e.close}},[e._v("CANCEL")]),t(a.Z,{staticClass:"cred",attrs:{type:"submit",disabled:!e.valid}},[e._v("SAVE")])],1)],1)],1)],1)],1)],1)],1),t(u.Z,{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[t(n.Z,[t(o.EB,{staticClass:"text-h6"},[e._v("Are you sure you want to delete this item?")]),t(o.h7,[t(w.Z),t(a.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("Cancel")]),t(a.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.deleteItemConfirm}},[e._v("OK")]),t(w.Z)],1)],1)],1),t(u.Z,{attrs:{"max-width":"500px"},model:{value:e.reviewMultidelete,callback:function(t){e.reviewMultidelete=t},expression:"reviewMultidelete"}},[t(n.Z,[t(o.EB,{staticClass:"text-h6"},[e._v("Are you sure you want to delete these reviews?")]),t(o.h7,[t(a.Z,{staticClass:"cred",on:{click:e.closeDelete1}},[e._v("Cancel")]),t(a.Z,{staticClass:"cred",on:{click:e.deleteMultipleReviews}},[e._v("OK")]),t(w.Z)],1)],1)],1)]},proxy:!0},{key:"item.action",fn:function({item:s}){return[t(v.Z,{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(s)}}},[e._v("mdi-pencil")]),t(v.Z,{attrs:{small:""},on:{click:function(t){return e.deleteItem(s)}}},[e._v(" mdi-delete")])]}},{key:"item.active",fn:function({item:s}){return[t(v.Z,{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(s)}}},[e._v("mdi-check")])]}},{key:"footer",fn:function(){return[t("div",{staticClass:"text-muted p-3"},[t(a.Z,{attrs:{color:"grey",large:""},on:{click:e.getSelectedIds}},[e._v("DELETE SELECTED")])],1)]},proxy:!0}],null,!0),model:{value:e.checkedIds,callback:function(t){e.checkedIds=t},expression:"checkedIds"}})],1),t(x.Z,{attrs:{timeout:e.timeout},scopedSlots:e._u([{key:"action",fn:function({}){return[t(a.Z,e._b({attrs:{color:"blue",text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",e.attrs,!1),[e._v("Close")])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v(e._s(e.text)+" ")])],1)])},y=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"col-4"},[t("h3",{staticClass:"fw-bold"},[e._v("Business Review")])])}],_=(s(7658),s(6154)),I={name:"ReviewsView",components:{},data:()=>({search:"",error:"",items:"",menu1:!1,menu2:!1,modal:!1,dialog:!1,selectedIds:[],checkedIds:[],dialogDelete:!1,reviewMultidelete:!1,users:[],businesses:[],cities:[],reviewRating:[{value:1},{value:2},{value:3},{value:4},{value:5}],headers:[{text:"Business Name",align:"start",sortable:!1,value:"bname"},{text:"Rating",value:"rating"},{text:"Mobile",value:"bphone"},{text:"City",value:"city"},{text:"Review",value:"review_text"},{text:"Created At",value:"formatted_created_at"},{text:"Review By User",value:"reviewby_name",sortable:!1},{text:"Actions",value:"action",sortable:!1}],reviews:[],editedIndex:-1,editedItem:{review:""},defaultItem:{review:""},valid:!1,review_textRules:[e=>!!e||"Review text is required.",e=>e.length<=50||"Review text must be less than 255 characters."],snackbar:!1,text:"",timeout:""}),computed:{formTitle(){return-1===this.editedIndex?"":"Edit Business Review"}},watch:{dialog(e){e||this.close()},dialogDelete(e){e||this.closeDelete()},reviewMultidelete(e){e||this.closeDelete1()}},created(){this.getAllreviews(),this.getSearchData()},methods:{getSelectedIds(){this.reviewMultidelete=!0},deleteMultipleReviews(){var e={ids:this.checkedIds.map((e=>e.id))};_.Z.post("admin/delete/multiple/reviews",e).then((e=>{1==e.data.success?(this.reviewMultidelete=!1,this.getAllreviews(),this.snackbar=!0,this.text=e.data.message,this.timeout=3e3):(this.reviewMultidelete=!1,this.getAllreviews(),this.snackbar=!0,this.text="Something went wrong",this.timeout=3e3)}))},closeDelete1(){this.reviewMultidelete=!1,this.$nextTick((()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1}))},exportData(){const e=this.$refs.myDataTable.items,t=[];e.forEach((e=>{const s={id:e.id,BusinessName:e.bname,Rating:e.name,Mobile:e.bphone,City:e.city,Review:e.review_text,Created:e.created_at,ReviewByUser:e.reviewby_name};t.push(s)}));const s=this.convertToCSV(t),i=document.createElement("a");i.setAttribute("href","data:text/csv;charset=utf-8,"+encodeURIComponent(s)),i.setAttribute("download","exported_data.csv"),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)},convertToCSV(e){const t=Object.keys(e[0]).join(",")+"\n",s=e.map((e=>Object.values(e).join(","))).join("\n");return t+s},getAllreviews(){_.Z.get("admin/reviews").then((e=>{this.reviews=e.data.reviews}))},editItem(e){this.editedIndex=this.reviews.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteItem(e){this.editedIndex=this.reviews.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},deleteItemConfirm(){let e={id:this.editedItem.id};_.Z.post("admin/review/delete",e).then((e=>{1==e.data.success?(this.snackbar=!0,this.text=e.data.message,this.timeout=3e3):(this.snackbar=!0,this.text="Something went wrong",this.timeout=3e3)})),this.reviews.splice(this.editedIndex,1),this.closeDelete()},close(){this.dialog=!1,this.$nextTick((()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1}))},closeDelete(){this.dialogDelete=!1,this.$nextTick((()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1}))},ReviewFormUpdate(){const e={headers:{"content-type":"multipart/form-data"}};let t={review_text:this.editedItem.review_text,review_id:this.editedItem.id};this.editedIndex>-1?(_.Z.post("admin/reviews/update",t,e).then((e=>{this.snackbar=!0,this.text=e.data.message,this.timeout=3e3,this.getAllreviews(),this.close()})).catch((e=>{this.error=e})),this.$refs.form.validate(),Object.assign(this.reviews[this.editedIndex],this.editedItem)):(this.reviews.push(this.editedItem),this.close())},getSearchData(){_.Z.get("get/information").then((e=>{this.cities=e.data.cities,this.businesses=e.data.businesses,this.users=e.data.users}))},getSelectedData(){var e={city:this.city,business:this.business,user:this.user,rating:this.rating,date1:this.date1,date2:this.date2};_.Z.post("search/reviews",e).then((e=>{console.log(e),this.reviews=e.data.reviews}))}}},C=I,D=s(1001),S=(0,D.Z)(C,Z,y,!1,null,null,null),R=S.exports},2648:function(e,t,s){s.d(t,{Z:function(){return o}});var i=s(9780),a=s(7678);const n=(0,a.Z)(i.Z);var o=n.extend({name:"v-textarea",props:{autoGrow:Boolean,noResize:Boolean,rowHeight:{type:[Number,String],default:24,validator:e=>!isNaN(parseFloat(e))},rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseInt(e,10))}},computed:{classes(){return{"v-textarea":!0,"v-textarea--auto-grow":this.autoGrow,"v-textarea--no-resize":this.noResizeHandle,...i.Z.options.computed.classes.call(this)}},noResizeHandle(){return this.noResize||this.autoGrow}},watch:{autoGrow(e){this.$nextTick((()=>{var t;e?this.calculateInputHeight():null===(t=this.$refs.input)||void 0===t||t.style.removeProperty("height")}))},lazyValue(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)},rowHeight(){this.autoGrow&&this.$nextTick(this.calculateInputHeight)}},mounted(){setTimeout((()=>{this.autoGrow&&this.calculateInputHeight()}),0)},methods:{calculateInputHeight(){const e=this.$refs.input;if(!e)return;e.style.height="0";const t=e.scrollHeight,s=parseInt(this.rows,10)*parseFloat(this.rowHeight);e.style.height=Math.max(s,t)+"px"},genInput(){const e=i.Z.options.methods.genInput.call(this);return e.tag="textarea",delete e.data.attrs.type,e.data.attrs.rows=this.rows,e},onInput(e){i.Z.options.methods.onInput.call(this,e),this.autoGrow&&this.calculateInputHeight()},onKeyDown(e){this.isFocused&&13===e.keyCode&&e.stopPropagation(),this.$emit("keydown",e)}}})},4802:function(e,t,s){var i=s(5352);const a=e=>{const{touchstartX:t,touchendX:s,touchstartY:i,touchendY:a}=e,n=.5,o=16;e.offsetX=s-t,e.offsetY=a-i,Math.abs(e.offsetY)<n*Math.abs(e.offsetX)&&(e.left&&s<t-o&&e.left(e),e.right&&s>t+o&&e.right(e)),Math.abs(e.offsetX)<n*Math.abs(e.offsetY)&&(e.up&&a<i-o&&e.up(e),e.down&&a>i+o&&e.down(e))};function n(e,t){const s=e.changedTouches[0];t.touchstartX=s.clientX,t.touchstartY=s.clientY,t.start&&t.start(Object.assign(e,t))}function o(e,t){const s=e.changedTouches[0];t.touchendX=s.clientX,t.touchendY=s.clientY,t.end&&t.end(Object.assign(e,t)),a(t)}function l(e,t){const s=e.changedTouches[0];t.touchmoveX=s.clientX,t.touchmoveY=s.clientY,t.move&&t.move(Object.assign(e,t))}function c(e){const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:e=>n(e,t),touchend:e=>o(e,t),touchmove:e=>l(e,t)}}function r(e,t,s){const a=t.value,n=a.parent?e.parentElement:e,o=a.options||{passive:!0};if(!n)return;const l=c(t.value);n._touchHandlers=Object(n._touchHandlers),n._touchHandlers[s.context._uid]=l,(0,i.XP)(l).forEach((e=>{n.addEventListener(e,l[e],o)}))}function d(e,t,s){const a=t.value.parent?e.parentElement:e;if(!a||!a._touchHandlers)return;const n=a._touchHandlers[s.context._uid];(0,i.XP)(n).forEach((e=>{a.removeEventListener(e,n[e])})),delete a._touchHandlers[s.context._uid]}const u={inserted:r,unbind:d};t["Z"]=u}}]);
//# sourceMappingURL=5509.ca811bbb.js.map